var m=function a(b,c){"use strict";function d(a){return"function"==typeof a}function e(a){return"[object Object]"===fa.call(a)}function f(a){return"[object String]"===fa.call(a)}function g(a){aa=a.document,ba=a.location,da=a.cancelAnimationFrame||a.clearTimeout,ca=a.requestAnimationFrame||a.setTimeout}function h(a,b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(e(a))return V(a,c);var g,h=null!=b&&e(b)&&!("tag"in b||"view"in b||"subtree"in b),i=h?b:{},j="class"in i?"class":"className",k={tag:"div",attrs:{}},l=[];if(!f(a))throw new Error("selector in m(selector, attrs, children) should be a string");for(;null!=(g=ga.exec(a));)if(""===g[1]&&g[2])k.tag=g[2];else if("#"===g[1])k.attrs.id=g[2];else if("."===g[1])l.push(g[2]);else if("["===g[3][0]){var m=ha.exec(g[3]);k.attrs[m[1]]=m[3]||!m[2]||""}var n=h?c.slice(1):c;1===n.length&&ea(n[0])?k.children=n[0]:k.children=n;for(var o in i)i.hasOwnProperty(o)&&(o===j&&null!=i[o]&&""!==i[o]?(l.push(i[o]),k.attrs[o]=""):k.attrs[o]=i[o]);return l.length&&(k.attrs[j]=l.join(" ")),k}function i(a,b){for(var c=0;c<a.length&&!b(a[c],c++););}function j(a,b){i(a,function(a,c){return(a=a&&a.attrs)&&null!=a.key&&b(a,c)})}function k(a){return null==a?"":"object"==typeof a?a:null==a.toString()?"":a}function l(a,b,c,d){try{n(a,b,c),b.nodeValue=d}catch(a){}}function m(a){for(var b=0;b<a.length;b++)ea(a[b])&&(a=a.concat.apply([],a),b--);return a}function n(a,b,c){a.insertBefore(b,a.childNodes[c]||null)}function o(a,b,c,d){j(a,function(a,d){b[a=a.key]=b[a]?{action:na,index:d,from:b[a].index,element:c.nodes[b[a].index]||aa.createElement("div")}:{action:ma,index:d}});var e=[];for(var f in b)e.push(b[f]);var g=e.sort(N),h=new Array(c.length);return h.nodes=c.nodes.slice(),i(g,function(b){var e=b.index;if(b.action===la&&(P(c[e].nodes,c[e]),h.splice(e,1)),b.action===ma){var f=aa.createElement("div");f.key=a[e].attrs.key,n(d,f,e),h.splice(e,0,{attrs:{key:a[e].attrs.key},nodes:[f]}),h.nodes[e]=f}if(b.action===na){var g=b.element,i=d.childNodes[e];i!==g&&null!==g&&d.insertBefore(g,i||null),h[e]=c[b.from],h.nodes[e]=g}}),h}function p(a,b,c,d){var e=a.length!==b.length;return e||j(a,function(a,c){var d=b[c];return e=d&&d.attrs&&d.attrs.key!==a.key}),e?o(a,c,b,d):b}function q(a,b,c){i(a,function(a,d){null!=b[d]&&c.push.apply(c,b[d].nodes)}),i(b.nodes,function(a,d){null!=a.parentNode&&c.indexOf(a)<0&&P([a],[b[d]])}),a.length<b.length&&(b.length=a.length),b.nodes=c}function r(a){var b=0;j(a,function(){return i(a,function(a){(a=a&&a.attrs)&&null==a.key&&(a.key="__mithril__"+b++)}),1})}function s(a,b,c){(a.tag!==b.tag||c.sort().join()!==Object.keys(b.attrs).sort().join()||a.attrs.id!==b.attrs.id||a.attrs.key!==b.attrs.key||"all"===h.redraw.strategy()&&(!b.configContext||b.configContext.retain!==!0)||"diff"===h.redraw.strategy()&&b.configContext&&b.configContext.retain===!1)&&(b.nodes.length&&P(b.nodes),b.configContext&&d(b.configContext.onunload)&&b.configContext.onunload(),b.controllers&&i(b.controllers,function(a){a.unload&&a.onunload({preventDefault:ja})}))}function t(a,b){return a.attrs.xmlns?a.attrs.xmlns:"svg"===a.tag?"http://www.w3.org/2000/svg":"math"===a.tag?"http://www.w3.org/1998/Math/MathML":b}function u(a,b,c){c.length&&(a.views=b,a.controllers=c,i(c,function(a){if(a.onunload&&a.onunload.$old&&(a.onunload=a.onunload.$old),Da&&a.onunload){var b=a.onunload;a.onunload=ja,a.onunload.$old=b}}))}function v(a,b,c,e,f){if(d(b.attrs.config)){var g=f.configContext=f.configContext||{};a.push(function(){return b.attrs.config.call(b,c,!e,g,f)})}}function w(a,b,d,e,f,g,h,i){var j=a.nodes[0];return e&&O(j,b.tag,b.attrs,a.attrs,f),a.children=M(j,b.tag,c,c,b.children,a.children,!1,0,b.attrs.contenteditable?j:d,f,h),a.nodes.intact=!0,i.length&&(a.views=g,a.controllers=i),j}function x(a,b,c){var d;a.$trusted?d=R(b,c,a):(d=[aa.createTextNode(a)],b.nodeName.match(ia)||n(b,d[0],c));var e="string"==typeof a||"number"==typeof a||"boolean"==typeof a?new a.constructor(a):a;return e.nodes=d,e}function y(a,b,c,d,e,f){var g=b.nodes;return d&&d===aa.activeElement||(a.$trusted?(P(g,b),g=R(c,e,a)):"textarea"===f?c.value=a:d?d.innerHTML=a:((1===g[0].nodeType||g.length>1)&&(P(b.nodes,b),g=[aa.createTextNode(a)]),l(c,g[0],e,a))),b=new a.constructor(a),b.nodes=g,b}function z(a,b,c,d,e,f,g){return 0===a.nodes.length?x(b,d,c):a.valueOf()!==b.valueOf()||e===!0?y(b,a,d,f,c,g):(a.nodes.intact=!0,a)}function A(a){if(a.$trusted){var b=a.match(/<[^\/]|\>\s*[^<]/g);if(null!=b)return b.length}else if(ea(a))return a.length;return 1}function B(a,b,d,e,f,g,h,i,k){a=m(a);var l=[],n=b.length===a.length,o=0,s={},t=!1;j(b,function(a,c){t=!0,s[b[c].attrs.key]={action:la,index:c}}),r(a),t&&(b=p(a,b,s,d));for(var u=0,v=0,w=a.length;v<w;v++){var x=M(d,f,b,e,a[v],b[u],g,e+o||o,h,i,k);x!==c&&(n=n&&x.nodes.intact,o+=A(x),b[u++]=x)}return n||q(a,b,l),b}function C(a,b,c,d,e){if(null!=b){if(fa.call(b)===fa.call(a))return b;if(e&&e.nodes){var f=c-d,g=f+(ea(a)?a:b.nodes).length;P(e.nodes.slice(f,g),e.slice(f,g))}else b.nodes&&P(b.nodes,b)}return b=new a.constructor,b.tag&&(b={}),b.nodes=[],b}function D(a,b){return b===c?a.attrs.is?aa.createElement(a.tag,a.attrs.is):aa.createElement(a.tag):a.attrs.is?aa.createElementNS(b,a.tag,a.attrs.is):aa.createElementNS(b,a.tag)}function E(a,b,c,d){return d?O(b,a.tag,a.attrs,{},c):a.attrs}function F(a,b,d,e,f,g){return null!=a.children&&a.children.length>0?M(b,a.tag,c,c,a.children,d.children,!0,0,a.attrs.contenteditable?b:e,f,g):a.children}function G(a,b,c,d,e,f,g){var h={tag:a.tag,attrs:b,children:c,nodes:[d]};return u(h,f,g),h.children&&!h.children.nodes&&(h.children.nodes=[]),"select"===a.tag&&"value"in a.attrs&&O(d,a.tag,{value:a.attrs.value},{},e),h}function H(a,b,c,d){var e="diff"===h.redraw.strategy()&&a?a.indexOf(b):-1;return e>-1?c[e]:"function"==typeof d?new d:{}}function I(a,b,c,d){null!=d.onunload&&Aa.push({controller:d,handler:d.onunload}),a.push(c),b.push(d)}function J(a,b,c,d,e,f){var g=H(c.views,b,d,a.controller),h=+(a&&a.attrs&&a.attrs.key);return a=0===Da||Ca||d&&d.indexOf(g)>-1?a.view(g):{tag:"placeholder"},"retain"===a.subtree?c:(h===h&&((a.attrs=a.attrs||{}).key=h),I(f,e,b,g),a)}function K(a,b,c,d){for(var e=b&&b.controllers;null!=a.view;)a=J(a,a.view.$original||a.view,b,e,d,c);return a}function L(a,b,c,d,e,g,h,i){var j=[],k=[];if(a=K(a,b,j,k),!a.tag&&k.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");a.attrs=a.attrs||{},b.attrs=b.attrs||{};var l=Object.keys(a.attrs),m=l.length>("key"in a.attrs?1:0);if(s(a,b,l),f(a.tag)){var o=0===b.nodes.length;h=t(a,h);var p;if(o){p=D(a,h);b=G(a,E(a,p,h,m),F(a,p,b,c,h,i),p,h,j,k)}else p=w(b,a,c,m,h,j,i,k);return(o||g===!0&&null!=p)&&n(d,p,e),v(i,a,p,o,b),b}}function M(a,b,c,f,g,h,i,j,l,m,n){return g=k(g),"retain"===g.subtree?h:(h=C(g,h,j,f,c),ea(g)?B(g,h,a,j,b,i,l,m,n):null!=g&&e(g)?L(g,h,l,a,j,i,m,n):d(g)?h:z(h,g,j,a,i,l,b))}function N(a,b){return a.action-b.action||a.index-b.index}function O(a,b,c,f,g){for(var h in c){var i=c[h],j=f[h];if(h in f&&j===i)"value"===h&&"input"===b&&a.value!=i&&(a.value=i);else{if(f[h]=i,"config"===h||"key"===h)continue;if(d(i)&&"on"===h.slice(0,2))a[h]=S(i,a);else if("style"===h&&null!=i&&e(i)){for(var k in i)null!=j&&j[k]===i[k]||(a.style[k]=i[k]);for(var k in j)k in i||(a.style[k]="")}else null!=g?"href"===h?a.setAttributeNS("http://www.w3.org/1999/xlink","href",i):a.setAttribute("className"===h?"class":h,i):h in a&&"list"!==h&&"style"!==h&&"form"!==h&&"type"!==h&&"width"!==h&&"height"!==h?"input"===b&&a[h]===i||(a[h]=i):a.setAttribute(h,i)}}return f}function P(a,b){for(var c=a.length-1;c>-1;c--)if(a[c]&&a[c].parentNode){try{a[c].parentNode.removeChild(a[c])}catch(a){}b=[].concat(b),b[c]&&Q(b[c])}a.length&&(a.length=0)}function Q(a){a.configContext&&d(a.configContext.onunload)&&(a.configContext.onunload(),a.configContext.onunload=null),a.controllers&&i(a.controllers,function(a){d(a.onunload)&&a.onunload({preventDefault:ja})}),a.children&&(ea(a.children)?i(a.children,Q):a.children.tag&&Q(a.children))}function R(a,b,c){var d=a.childNodes[b];if(d){var e=1!==d.nodeType,f=aa.createElement("span");e?(a.insertBefore(f,d||null),f.insertAdjacentHTML("beforebegin",c),a.removeChild(f)):d.insertAdjacentHTML("beforebegin",c)}else oa(a,c);for(var g=[];a.childNodes[b]!==d;)g.push(a.childNodes[b]),b++;return g}function S(a,b){return function(c){c=c||event,h.redraw.strategy("diff"),h.startComputation();try{return a.call(b,c)}finally{Y()}}}function T(a){var b=qa.indexOf(a);return b<0?qa.push(a)-1:b}function U(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.toJSON=function(){return a},b}function V(a,b){var c=function(){return(a.controller||ja).apply(this,b)||this};a.controller&&(c.prototype=a.controller.prototype);var d=function(c){var d=arguments.length>1?b.concat([].slice.call(arguments,1)):b;return a.view.apply(a,d?[c].concat(d):[c])};d.$original=a.view;var e={controller:c,view:d};return b[0]&&null!=b[0].key&&(e.attrs={key:b[0].key}),e}function W(a,b){ta.splice(b,1),va.splice(b,1),ua.splice(b,1),Z(a),qa.splice(T(a),1)}function X(){ya&&(ya(),ya=null),i(ta,function(a,b){var c=ua[b];if(va[b]){var d=[va[b]];h.render(a,c.view?c.view(va[b],d):"")}}),za&&(za(),za=null),wa=null,xa=new Date,h.redraw.strategy("diff")}function Y(){"none"===h.redraw.strategy()?(Da--,h.redraw.strategy("diff")):h.endComputation()}function Z(a){var b=T(a);P(a.childNodes,ra[b]),ra[b]=c}function $(a,b){var c=h.prop(b);return a.then(c),c.then=function(c,d){return $(a.then(c,d),b)},c.catch=c.then.bind(null,null),c.finally=function(a){var d=function(){return h.deferred().resolve(a()).promise};return c.then(function(a){return $(d().then(function(){return a}),b)},function(a){return $(d().then(function(){throw new Error(a)}),b)})},c}function _(a,b){function c(a){n=a||l,p.map(function(a){n===k?a.resolve(o):a.reject(o)})}function f(a,b,c,f){if((null!=o&&e(o)||d(o))&&d(a))try{var g=0;a.call(o,function(a){g++||(o=a,b())},function(a){g++||(o=a,c())})}catch(a){h.deferred.onerror(a),o=a,c()}else f()}function g(){var e;try{e=o&&o.then}catch(a){return h.deferred.onerror(a),o=a,n=j,g()}f(e,function(){n=i,g()},function(){n=j,g()},function(){try{n===i&&d(a)?o=a(o):n===j&&d(b)&&(o=b(o),n=i)}catch(a){return h.deferred.onerror(a),o=a,c()}o===m?(o=TypeError(),c()):f(e,function(){c(k)},c,function(){c(n===i&&k)})})}var i=1,j=2,k=3,l=4,m=this,n=0,o=0,p=[];m.promise={},m.resolve=function(a){return n||(o=a,n=i,g()),this},m.reject=function(a){return n||(o=a,n=j,g()),this},m.promise.then=function(a,b){var c=new _(a,b);return n===k?c.resolve(o):n===l?c.reject(o):p.push(c),c.promise}}var aa,ba,ca,da,ea=Array.isArray||function(a){return"[object Array]"===fa.call(a)},fa={}.toString,ga=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,ha=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,ia=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,ja=function(){};g(b),h.version=function(){return"v0.2.1-lila-vdom-only"};var ka,la=1,ma=2,na=3,oa=function(){var a=function(a,b){a.appendChild(aa.createRange().createContextualFragment(b))},b=function(a,b){a.insertAdjacentHTML("beforeend",b)};try{return aa.createRange().createContextualFragment("x"),a}catch(a){return b}}(),pa={appendChild:function(a){ka===c&&(ka=aa.createElement("html")),aa.documentElement&&aa.documentElement!==a?aa.replaceChild(a,aa.documentElement):aa.appendChild(a),this.childNodes=aa.childNodes},insertBefore:function(a){this.appendChild(a)},childNodes:[]},qa=[],ra={};h.render=function(a,b,d){var e=[];if(!a)throw new Error("Ensure the DOM element being passed to m.mount/m.render is not undefined.");var f=T(a),g=a===aa,h=g||a===aa.documentElement?pa:a;g&&"html"!==b.tag&&(b={tag:"html",attrs:{},children:b}),ra[f]===c&&P(h.childNodes),d===!0&&Z(a),ra[f]=M(h,null,c,c,b,ra[f],!1,0,null,c,e),i(e,function(a){a()})},h.trust=function(a){return a=new String(a),a.$trusted=!0,a},h.prop=function(a){return(null!=a&&e(a)||d(a))&&d(a.then)?$(a):U(a)};var sa,ta=[],ua=[],va=[],wa=null,xa=0,ya=null,za=null,Aa=[];h.component=function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);return V(a,b)},h.mount=h.module=function(a,b){if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var c=ta.indexOf(a);c<0&&(c=ta.length);var e=!1,f={preventDefault:function(){e=!0,ya=za=null}};i(Aa,function(a){a.handler.call(a.controller,f),a.controller.onunload=null}),e?i(Aa,function(a){a.controller.onunload=a.handler}):Aa=[],va[c]&&d(va[c].onunload)&&va[c].onunload(f);var g=null===b;if(!e){h.redraw.strategy("all"),h.startComputation(),ta[c]=a;var j=sa=b?b:b={controller:ja},k=new(b.controller||ja);return j===sa&&(va[c]=k,ua[c]=b),Y(),g&&W(a,c),va[c]}g&&W(a,c)};var Ba=!1,Ca=!1;h.redraw=function(a){if(!Ba){Ba=!0,a&&(Ca=!0);try{wa&&!a?(ca===b.requestAnimationFrame||new Date-xa>16)&&(wa>0&&da(wa),wa=ca(X,16)):(X(),wa=ca(function(){wa=null},16))}finally{Ba=Ca=!1}}},h.redraw.strategy=h.prop();var Da=0;return h.startComputation=function(){Da++},h.endComputation=function(){Da>1?Da--:(Da=0,h.redraw())},h.withAttr=function(a,b,c){return function(d){d=d||event;var e=d.currentTarget||this,f=c||this;b.call(f,a in e?e[a]:e.getAttribute(a))}},h.deferred=function(){var a=new _;return a.promise=$(a.promise),a},h.deferred.onerror=function(a){if("[object Error]"===fa.call(a)&&!a.constructor.toString().match(/ Error/))throw Da=0,a},h.sync=function(a){function b(a,b){return function(g){return f[a]=g,b||(c="reject"),0==--e&&(d.promise(f),d[c](f)),g}}var c="resolve",d=h.deferred(),e=a.length,f=new Array(e);return a.length>0?i(a,function(a,c){a.then(b(c,!0),b(c,!1))}):d.resolve([]),d.promise},h.deps=function(a){return g(b=a||b),b},h.deps.factory=a,h}("undefined"!=typeof window?window:{});"object"==typeof module&&null!=module&&module.exports?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m});
//# sourceMappingURL=mithril.min.js.map